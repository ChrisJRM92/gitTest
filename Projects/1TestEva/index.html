<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Prueba Tienda - Validaciones con errores</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="utilitarios.js"></script>
    <script src="scripts.js"></script>
  </head>

  <body onload="mostrarSeccion('seccion1'); cargarProductos(); getCategories(); getCart();">
    <!-- Logos fijos a los lados -->
    <!-- <img src="./imagenes/logo.png" alt="Logo Izquierdo" id="logo-izquierdo" /> -->
    <!-- <img src="./imagenes/logo.png" alt="Logo Derecho" id="logo-derecho" /> -->

    <nav class="menu">
      <button onclick="mostrarSeccion('seccion1')">Productos</button>
      <button onclick="mostrarSeccion('seccion2')">Categorías</button>
      <button onclick="mostrarSeccion('seccion3')">Carrito</button>
      <button onclick="mostrarSeccion('seccion4')">Cliente</button>
      <button onclick="mostrarSeccion('seccion5')">Resumen Ventas</button>
    </nav>

    <!-- Sección 1: Gestión de productos -->
    <div id="seccion1" class="seccion" style="display: none">
      <div class="contenido-seccion">
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
          "
        >
          <h2>Gestión de productos</h2>
          <button
            style="width: 150px; height: 40px"
            onclick="handleOpenModalProduct()"
          >
            Agregar producto
          </button>
        </div>

        <dialog id="addProductModal" closedby="any">
          <h3>Agregar producto</h3>
          <label for="">Nombre</label>
          <input type="text" id="nombreN" />
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorEmpyName">* El nombre no puede quedar vacio</p>
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorOnlyChar">* Se permiten solo letras</p>
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorUpperName">* La primera letra debe ser mayuscula</p>
          <label for="">Descripcion</label>
          <input type="text" id="descripcionN" />
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorEmpyDesc">* La descripcion no puede quedar vacio</p>
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorOnlyCharDesc">* Se permiten solo letras</p>
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorUpperDesc">* La primera letra debe ser mayuscula</p>
          <label for="">Categoria</label>
          <select
            style="width: 100%; height: 30px"
            name=""
            id="categoriaN"
          ></select>
          <label for="">Precio</label>
          <input type="number" id="precioN" min="0" step="any" />
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorEmpyPrice">* El precio no puede quedar vacio</p>
          <label for="">Stock</label>
          <input type="number" id="stockN" min="0" step="1" />
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorEmpyStock">* El stock no puede quedar vacio</p>
          <button onclick="saveNewProduct()">Guardar</button>
          <button onclick="handleCloseModal()">Cerrar</button>
        </dialog>

        <dialog id="modalChangeData" closedby="any">
          <h3>Editar producto</h3>
          <label for="">Id</label>
          <input type="text" id="id" disabled />
          <label for="">Nombre</label>
          <input type="text" id="nombre" />
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorEmpyNameEdit">* El nombre no puede quedar vacio</p>
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorOnlyCharEdit">* Se permiten solo letras</p>
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorUpperNameEdit">* La primera letra debe ser mayuscula</p>
          <label for="">Descripcion</label>
          <input type="text" id="descripcion" />
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorEmpyDescEdit">* La descripcion no puede quedar vacio</p>
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorOnlyCharDescEdit">* Se permiten solo letras</p>
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorUpperDescEdit">* La primera letra debe ser mayuscula</p>
          <label for="">Categoria</label>
          <select
            style="width: 100%; height: 30px"
            name=""
            id="categoria"
          ></select>
          <label for="">Precio</label>
          <input type="number" id="precio" min="0" step="any" />
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorEmpyPriceEdit">* El precio no puede quedar vacio</p>
          <label for="">Stock</label>
          <input type="number" id="stock" min="0" step="1" />
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorEmpyStockEdit">* El stock no puede quedar vacio</p>
          <button onclick="saveDataModalProduct()">Guardar</button>
          <button onclick="closeModalEdit()">Cerrar</button>
        </dialog>

        <dialog id="modalDeleteProduct" closedby="any">
          <p>Modal eliminar</p>
          <p>¿Deseas elminar este articulo?</p>
          <input
            style="width: 230px; display: block"
            type="text"
            id="idDP"
            disabled
          />
          <input
            style="width: 230px; display: block"
            type="text"
            id="nombreDP"
            disabled
          />
          <input
            style="width: 230px; display: block"
            type="text"
            id="descripcionDP"
            disabled
          />
          <input
            style="width: 230px; display: block"
            type="text"
            id="categoriasDP"
            disabled
          />
          <input
            style="width: 230px; display: block"
            type="text"
            id="preciokDP"
            disabled
          />
          <input
            style="width: 230px; display: block"
            type="text"
            id="stockDP"
            disabled
          />
          <button onclick="handleDeleteProduct()">Eliminar</button>
          <button onclick="closeModaleDeleteProduct()">Cerrar</button>
        </dialog>

        <h3>Productos Registrados</h3>
        <table id="tablaProductos">
          <thead>
            <tr>
              <th>Id</th>
              <th>Nombre</th>
              <th>Descripcion</th>
              <th>Categoria</th>
              <th>Precio</th>
              <th>Stock</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody id="tableBody"></tbody>
        </table>

        <div id="estadisticasProductos">
          <p>Total productos: <span id="totalProductos">0</span></p>
          <p>Stock total: <span id="stockTotal">0</span></p>
          <p>Valor inventario: $<span id="valorInventario">0.00</span></p>
        </div>
      </div>
    </div>


    <!-- Sección 2: Gestión de categorías -->
    <div id="seccion2" class="seccion" style="display: none">
      <div class="contenido-seccion">
        <div style="display: flex; justify-content: space-between; align-items: center;">
          <h2>Gestión de Categorías</h2>
          <button style="width: 150px; height: 40px;" onclick="handleOpenModalCategory()">Agregar categoria</button>
        </div>
        

        <dialog id="modalAddCategory" closedby="any">
          <h3>Agregar Categoria</h3>
          <div class="campo">
            <label for="nombreCategoria">Nombre Categoría:</label>
            <input type="text" id="nombreCategoria" placeholder="Ej: Ropa" />
            <p style="margin: 0; color: rgb(255, 69, 69)" id="errorEmpyNameCategory">* El nombre no puede quedar vacio</p>
            <p style="margin: 0; color: rgb(255, 69, 69)" id="errorOnlyCharCategory">* Se permiten solo letras</p>
            <p style="margin: 0; color: rgb(255, 69, 69)" id="errorUpperNameCategory">* La primera letra debe ser mayuscula</p>          
        </div>

        <div class="campo">
          <label for="descripcionCategoria">Descripción Corta:</label>
          <input
            type="text"
            id="descripcionCategoria"
            maxlength="50"
            placeholder="Opcional"
          />
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorEmpyDescCategory">* La descripcion no puede quedar vacio</p>
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorOnlyCharDescCategory">* Se permiten solo letras</p>
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorUpperDescCategory">* La primera letra debe ser mayuscula</p> 
        </div>

        <div class="campo">
          <button type="button" onclick="handleAddCategory()">Añadir</button>
          <button type="button" onclick="handleCloseModalCategory()">Cerrar</button>
        </div>
        </dialog>

        <dialog id="modalEditCategory" closedby="any">
          <h3>Modificar categoria</h3>
          <label for="">Id</label>
          <input type="text" id="idCategoryEdit" disabled>
          <label for="">Nombre</label>
          <input type="text" id="nameCategoryEdit">
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorEmpyNameCategorySection">* El nombre no puede quedar vacio</p>
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorOnlyCharCategorySection">* Se permiten solo letras</p>
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorUpperNameCategorySection">* La primera letra debe ser mayuscula</p>
          <label for="">Descripcion</label>
          <input type="text" id="descriptionCategoryEdit">
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorEmpyDescCategorySection">* El nombre no puede quedar vacio</p>
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorOnlyCharDescCategorySection">* Se permiten solo letras</p>
          <p style="margin: 0; color: rgb(255, 69, 69)" id="errorUpperNameDescCategorySection">* La primera letra debe ser mayuscula</p>
          <button onclick="handleSaveDataCategory()">Guardar</button>
          <button onclick="handleCloseModalEditCategory()">Cerrar</button>
        </dialog>

        <dialog style="width: 300px;" id="modalDeleteCategory" closedby="any">
          <h3>Modificar categoria</h3>
          <p>¿Deseas eliminar esta caegoria?</p>
          <input type="text" id="idCategoryDelete" disabled>
          <input type="text" id="nameCategoryDelete" disabled>
          <input type="text" id="descriptionCategoryDelete" disabled>
          <button onclick="handleDeleteCategory()" >Eliminar</button>
          <button onclick="handleCloseModalDeleteCategory()">Cerrar</button>
        </dialog>
        
        <h3>Categorías Registradas</h3>

        <ul id="listaCategorias">
          <table>
            <thead>
              <tr>
                <th>Id</th>
                <th>Nombre</th>
                <th>Descripcion</th>
                <th>Acciones</th>
            </tr>
            </thead>
            <tbody id="dataBodyCategory">
            </tbody>
          </table>
        </ul>
      </div>
    </div>

    <!-- Sección 3: Carrito de compras -->
    <div id="seccion3" class="seccion" style="display: none">
      <div class="contenido-seccion">
        <div style="display: flex; justify-content: space-between; align-items: center;">
          <h2>Carrito de compras</h2>
          <button style="width: 150px; height: 40px;" onclick="handleOpenModalCartAddProduct()">Añadir productos</button>
        </div>

        <dialog id="modalAddNewBuy" closedby="any">
          <h3>Agregar artículos al carrito</h3>
          <p>Productos disponibles</p>
          <table>
            <thead>
              <tr>
                <th>id</th>
                <th>Nombre</th>
                <th>Descripcion</th>
                <th>Precio</th>
                <th>Cantidad</th>
                <th>Carrito</th>
              </tr>
              </thead>
            <tbody id="itemsProductAvailable">
              
            </tbody>
          </table>
        </dialog>
        
        <h3>Resumen del Carrito</h3>
        <table id="tablaCarrito">
          <thead>
            <tr>
              <th>id</th>
              <th>Producto</th>
              <th>Cantidad</th>
              <th>P. Unitario</th>
              <th>Subtotal</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody id="dataBodyCart">
            
          </tbody>
        </table>
        <p>Subtotal: $<span id="SubtotalCarrito">0.00</span></p>
        <p>Iva: <span id="iva">12</span>%</p>
        <p>Total: $<span id="totalCarrito">0.00</span></p>
      </div>
    </div>

    <!-- Sección 4: Formulario Cliente -->
    <div id="seccion4" class="seccion" style="display: none">
      <div class="contenido-seccion">
        <h2>Datos del Cliente (Reto Grupal)</h2>

        <div class="campo">
          <label for="nombreCliente">Nombre Completo:</label>
          <input type="text" id="nombreCliente" placeholder="Ej: Juan Pérez" />
          <div class="error" id="errorNombreCliente"></div>
        </div>

        <div class="campo">
          <label for="emailCliente">Correo Electrónico:</label>
          <input
            type="email"
            id="emailCliente"
            placeholder="Ej: juan@example.com"
          />
          <div class="error" id="errorEmailCliente"></div>
        </div>

        <div class="campo">
          <label for="telefonoCliente">Teléfono:</label>
          <input type="tel" id="telefonoCliente" placeholder="Ej: 0991234567" />
          <div class="error" id="errorTelefonoCliente"></div>
        </div>

        <div class="campo">
          <label for="direccionCliente">Dirección:</label>
          <textarea
            id="direccionCliente"
            placeholder="Ej: Calle Falsa 123"
          ></textarea>
          <div class="error" id="errorDireccionCliente"></div>
        </div>

        <div class="campo">
          <button type="button" onclick="finalizarCompra()">
            Finalizar Compra
          </button>
        </div>
      </div>
    </div>

    <!-- Sección 5: Resumen de ventas -->
    <div id="seccion5" class="seccion" style="display: none">
      <div class="contenido-seccion">
        <h2>Resumen de Ventas (Reto Grupal)</h2>

        <table id="tablaVentas">
          <thead>
            <tr>
              <th>Cliente</th>
              <th>Productos</th>
              <th>Total</th>
            </tr>
          </thead>
          <tbody>
            <!-- Ventas aparecerán aquí -->
          </tbody>
        </table>
        <div id="estadisticasVentas">
          <p>Total Ventas: $<span id="totalVentas">0.00</span></p>
          <p>Producto más vendido: <span id="productoMasVendido">-</span></p>
        </div>
      </div>
    </div>

    <script>
      function mostrarSeccion(id) {
        document.querySelectorAll(".seccion").forEach((div) => {
          div.style.display = div.id === id ? "block" : "none";
        });
      }
    </script>
  </body>
</html>
